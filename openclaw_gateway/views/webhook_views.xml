<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Webhook Log List View (Odoo 18: list not tree) -->
        <record id="view_webhook_log_list" model="ir.ui.view">
            <field name="name">openclaw.webhook.log.list</field>
            <field name="model">openclaw.webhook.log</field>
            <field name="arch" type="xml">
                <list string="Webhook Logs" default_order="create_date desc" create="false" edit="false">
                    <field name="create_date"/>
                    <field name="webhook_id"/>
                    <field name="status_code"/>
                    <field name="success" decoration-success="success" decoration-danger="not success"/>
                    <field name="execution_time_ms"/>
                    <field name="source_ip"/>
                </list>
            </field>
        </record>

        <!-- Webhook Log Form View -->
        <record id="view_webhook_log_form" model="ir.ui.view">
            <field name="name">openclaw.webhook.log.form</field>
            <field name="model">openclaw.webhook.log</field>
            <field name="arch" type="xml">
                <form string="Webhook Log" create="false" edit="false">
                    <sheet>
                        <group>
                            <group string="Request Info">
                                <field name="create_date"/>
                                <field name="webhook_id"/>
                                <field name="source_ip"/>
                                <field name="n8n_workflow_id"/>
                            </group>
                            <group string="Response Info">
                                <field name="status_code"/>
                                <field name="success"/>
                                <field name="execution_time_ms"/>
                                <field name="error_message"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Request Payload" name="payload">
                                <field name="payload_json" widget="ace" options="{'mode': 'json'}" nolabel="1"/>
                            </page>
                            <page string="Response Data" name="response">
                                <field name="response_json" widget="ace" options="{'mode': 'json'}" nolabel="1"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Webhook Log Search View -->
        <record id="view_webhook_log_search" model="ir.ui.view">
            <field name="name">openclaw.webhook.log.search</field>
            <field name="model">openclaw.webhook.log</field>
            <field name="arch" type="xml">
                <search string="Webhook Logs">
                    <field name="webhook_id"/>
                    <field name="source_ip"/>
                    <field name="n8n_workflow_id"/>
                    <filter string="Success" name="filter_success" domain="[('success', '=', True)]"/>
                    <filter string="Failed" name="filter_failed" domain="[('success', '=', False)]"/>
                </search>
            </field>
        </record>

        <!-- Workflow Job List View (Odoo 18: list not tree) -->
        <record id="view_workflow_job_list" model="ir.ui.view">
            <field name="name">openclaw.workflow.job.list</field>
            <field name="model">openclaw.workflow.job</field>
            <field name="arch" type="xml">
                <list string="Workflow Jobs" default_order="create_date desc">
                    <field name="create_date"/>
                    <field name="job_id"/>
                    <field name="workflow_type"/>
                    <field name="status" decoration-success="status == 'completed'" decoration-warning="status == 'running'" decoration-danger="status == 'failed'"/>
                    <field name="progress_percent"/>
                </list>
            </field>
        </record>

        <!-- Workflow Job Form View -->
        <record id="view_workflow_job_form" model="ir.ui.view">
            <field name="name">openclaw.workflow.job.form</field>
            <field name="model">openclaw.workflow.job</field>
            <field name="arch" type="xml">
                <form string="Workflow Job">
                    <sheet>
                        <group>
                            <group string="Job Info">
                                <field name="job_id"/>
                                <field name="workflow_type"/>
                                <field name="status"/>
                                <field name="progress_percent"/>
                                <field name="n8n_execution_id"/>
                                <field name="estimated_completion"/>
                            </group>
                            <group string="Result">
                                <field name="error_message"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Result Data" name="result">
                                <field name="result_json" widget="ace" options="{'mode': 'json'}" nolabel="1"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Workflow Job Search View -->
        <record id="view_workflow_job_search" model="ir.ui.view">
            <field name="name">openclaw.workflow.job.search</field>
            <field name="model">openclaw.workflow.job</field>
            <field name="arch" type="xml">
                <search string="Workflow Jobs">
                    <field name="job_id"/>
                    <field name="workflow_type"/>
                    <field name="status"/>
                    <filter string="Pending" name="filter_pending" domain="[('status', '=', 'pending')]"/>
                    <filter string="Running" name="filter_running" domain="[('status', '=', 'running')]"/>
                    <filter string="Completed" name="filter_completed" domain="[('status', '=', 'completed')]"/>
                    <filter string="Failed" name="filter_failed" domain="[('status', '=', 'failed')]"/>
                </search>
            </field>
        </record>

        <!-- Webhook Log Action -->
        <record id="action_openclaw_webhook_log" model="ir.actions.act_window">
            <field name="name">Webhook Logs</field>
            <field name="res_model">openclaw.webhook.log</field>
            <field name="view_mode">list,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_empty_folder">No webhook calls logged yet</p>
                <p>Webhook logs appear here when N8N calls /webhook/n8n/&lt;webhook_id&gt;.</p>
            </field>
        </record>

        <!-- Workflow Job Action -->
        <record id="action_openclaw_workflow_job" model="ir.actions.act_window">
            <field name="name">Workflow Jobs</field>
            <field name="res_model">openclaw.workflow.job</field>
            <field name="view_mode">list,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_empty_folder">No workflow jobs yet</p>
                <p>Jobs are created when N8N sends workflow_status webhooks or when bulk operations run.</p>
            </field>
        </record>
    </data>
</odoo>
